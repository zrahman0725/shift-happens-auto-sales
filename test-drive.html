<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Drive - Shift Happens Auto Sales</title>

    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel="stylesheet">

    <link rel="stylesheet" href="css/test-drive.css">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico?">

</head>

<body>

    <header class="header">
        <a href="index.html" class="logo"><img src="images/IMG-20241122-WA0003_1468205583269761 (1).png" alt="">Shift Happens Auto Sales</a>

        <i class='bx bx-menu' id="menu-icon"></i>

        <nav class="navbar">
            <a href="index.html#home" data-alt-link="home.html">Home</a>
            <div class="dropdown">
                <a href="inventory.html" data-alt-link="inventory.html">Inventory</a>
                <div class="dropdown-menu">
                    <a href="inventory.html">View Inventory</a>
                    <a href="car-finder.html">Car Finder</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="finance.html" data-alt-link="finance.html">Finance</a>
                <div class="dropdown-menu">
                    <a href="finance-application.html">Finance Application</a>
                    <a href="finance.html">Finance Department</a>
                    <a href="finance.html#credit">Credit Tips</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="services.html" data-alt-link="services.html" class="active">Services</a>
                <div class="dropdown-menu">
                    <a href="detailing.html">Detailing</a>
                    <a href="trade-in.html">Trade-ins</a>
                    <a href="test-drive.html">Test Drives</a>
                    <a href="car-loan.html">Loan Calculator</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="about.html" data-alt-link="about.html">Dealership</a>
                <div class="dropdown-menu">
                    <a href="about.html">About Us</a>
                    <a href="index.html#contact-form">Contact</a>
                </div>
            </div>
        </nav>
        
        
    </header>

    <section class="form" id="form">
        <h2 class="heading">Schedule Your <span>Test Drive</span></h2>
        <div class="description-box">
            <p>Experience your next vehicle firsthand! Schedule a test drive today and feel the thrill of being behind the wheel. Provide your details below, and let us help you find the perfect time to take your dream car for a spin.</p>
        </div>
        <form class="test-drive-from">
            <h3>Personal Information</h3>
            <div class="form-group">
                <div>
                    <label for="first-name">First Name <span class="required">*</span></label>
                    <input type="text" id="first-name" name="first-name" placeholder="Enter your first name" required>
                </div>
                <div>
                    <label for="last-name">Last Name <span class="required">*</span></label>
                    <input type="text" id="last-name" name="last-name" placeholder="Enter your last name" required>
                </div>
                <div>
                    <label for="phone">Phone Number <span class="required">*</span></label>
                    <input type="tel" id="phone" name="phone" placeholder="Enter your phone number" required>
                </div>
                <div>
                    <label for="email">Email Address <span class="required">*</span></label>
                    <input type="email" id="email" name="email" placeholder="Enter your email" required>
                </div>
                <div>
                    <label for="contact-method">Preferred Method of Contact <span class="required">*</span></label>
                    <select id="contact-method" name="contact-method" required>
                        <option value="" disabled selected>Select an option</option>
                        <option value="sms">SMS</option>
                        <option value="call">Call</option>
                        <option value="email">Email</option>
                    </select>
                </div>
            </div>

                        <h3>Choose Your Vehicle</h3>
                        <div class="form-group">
                            <div>
                                <label for="vehicle-search">Search for a Vehicle</label>
                                <input type="text" id="vehicle-search" placeholder="Search (Year Make Model)" autocomplete="off" />
                                <ul id="vehicle-options" class="dropdown-options"></ul>
                            </div>
                            <div id="selected-vehicle" class="selected-vehicle" style="display: none;">
                                <p id="selected-vehicle-text"></p>
                                <button id="clear-selection" type="button">
                                    <i class="bx bx-trash"></i> <!-- Trash icon -->
                                </button>
                            </div>
                        </div>
                        <h3>Availability</h3>
                        <div class="availability-container">
                            <!-- Days of the week -->
                            <div class="day" data-day="Monday">
                                <label>
                                    <input type="checkbox" name="days" value="Monday" class="day-toggle">
                                    Monday
                                </label>
                                <div class="time-picker" style="display: none;">
                                    <div class="time-slot">
                                        <select name="Monday-start-time" class="start-time">
                                            <!-- Dynamically populated options -->
                                        </select>
                                        to
                                        <select name="Monday-end-time" class="end-time">
                                            <!-- Dynamically populated options -->
                                        </select>
                                        <button type="button" class="add-time-slot" data-day="Monday">+</button>
                                    </div>
                                    <div class="selected-times"></div>
                                </div>
                            </div>
                            <div class="day" data-day="Tuesday">
                                <label>
                                    <input type="checkbox" name="days" value="Tuesday" class="day-toggle">
                                    Tuesday
                                </label>
                                <div class="time-picker" style="display: none;">
                                    <div class="time-slot">
                                        <select name="Tuesday-start-time" class="start-time">
                                            <!-- Dynamically populated options -->
                                        </select>
                                        to
                                        <select name="Tuesday-end-time" class="end-time">
                                            <!-- Dynamically populated options -->
                                        </select>
                                        <button type="button" class="add-time-slot" data-day="Tuesday">+</button>
                                    </div>
                                    <div class="selected-times"></div>
                                </div>
                            </div>
                            <!-- Repeat for all other days (Wednesday to Sunday) -->
                            <div class="day" data-day="Wednesday">
                                <label>
                                    <input type="checkbox" name="days" value="Wednesday" class="day-toggle">
                                    Wednesday
                                </label>
                                <div class="time-picker" style="display: none;">
                                    <div class="time-slot">
                                        <select name="Wednesday-start-time" class="start-time"></select>
                                        to
                                        <select name="Wednesday-end-time" class="end-time"></select>
                                        <button type="button" class="add-time-slot" data-day="Wednesday">+</button>
                                    </div>
                                    <div class="selected-times"></div>
                                </div>
                            </div>
                            <!-- Repeat for Thursday, Friday, Saturday, Sunday -->
                            <div class="day" data-day="Thursday">
                                <label>
                                    <input type="checkbox" name="days" value="Thursday" class="day-toggle">
                                    Thursday
                                </label>
                                <div class="time-picker" style="display: none;">
                                    <div class="time-slot">
                                        <select name="Thursday-start-time" class="start-time"></select>
                                        to
                                        <select name="Thursday-end-time" class="end-time"></select>
                                        <button type="button" class="add-time-slot" data-day="Thursday">+</button>
                                    </div>
                                    <div class="selected-times"></div>
                                </div>
                            </div>
                            <div class="day" data-day="Friday">
                                <label>
                                    <input type="checkbox" name="days" value="Friday" class="day-toggle">
                                    Friday
                                </label>
                                <div class="time-picker" style="display: none;">
                                    <div class="time-slot">
                                        <select name="Friday-start-time" class="start-time"></select>
                                        to
                                        <select name="Friday-end-time" class="end-time"></select>
                                        <button type="button" class="add-time-slot" data-day="Friday">+</button>
                                    </div>
                                    <div class="selected-times"></div>
                                </div>
                            </div>
                            <div class="day" data-day="Saturday">
                                <label>
                                    <input type="checkbox" name="days" value="Saturday" class="day-toggle">
                                    Saturday
                                </label>
                                <div class="time-picker" style="display: none;">
                                    <div class="time-slot">
                                        <select name="Saturday-start-time" class="start-time"></select>
                                        to
                                        <select name="Saturday-end-time" class="end-time"></select>
                                        <button type="button" class="add-time-slot" data-day="Saturday">+</button>
                                    </div>
                                    <div class="selected-times"></div>
                                </div>
                            </div>

                        </div>
                        
                        
                        

                        
                        
                        <button type="submit">Submit Application</button>
                    </form>
                </section>

    <footer class="footer">
        <div class="footer-text">
            <p>Copyright &copy; 2024 by Shift Happens Auto Sales | All Rights Reserved. | <a href="admin-login.html">Admin</a> </p>
        </div>

        <div class="footer-iconTop">
            <a href="#"><i class='bx bx-up-arrow-alt'></i></a>
        </div>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const urlParams = new URLSearchParams(window.location.search);
            const selectedVehicle = urlParams.get("vehicle");

            if (selectedVehicle) {
                const vehicleSearchInput = document.getElementById("vehicle-search");
                const selectedVehicleText = document.getElementById("selected-vehicle-text");
                const selectedVehicleContainer = document.getElementById("selected-vehicle");

                vehicleSearchInput.value = selectedVehicle;
                selectedVehicleText.textContent = selectedVehicle;
                selectedVehicleContainer.style.display = "flex";
            }

            const clearButton = document.getElementById("clear-selection");
            clearButton.addEventListener("click", () => {
                const vehicleSearchInput = document.getElementById("vehicle-search");
                const selectedVehicleContainer = document.getElementById("selected-vehicle");

                vehicleSearchInput.value = "";
                selectedVehicleContainer.style.display = "none";
            });
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";
    
        const firebaseConfig = {
            apiKey: "AIzaSyDv6Jkk-7XqeCMTy14Fjs_upMAjVM7uNVg",
            authDomain: "shift-happens-auto-sales.firebaseapp.com",
            projectId: "shift-happens-auto-sales",
            storageBucket: "shift-happens-auto-sales.appspot.com",
            messagingSenderId: "224158026936",
            appId: "1:224158026936:web:690dd13405f6b1bfc4b84d"
        };
    
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
    
        let vehicleList = [];
    
        async function populateVehicleList() {
            const inventoryRef = collection(db, 'inventory');
            const inventorySnapshot = await getDocs(inventoryRef);
    
            vehicleList = []; // Reset the vehicle list
    
            inventorySnapshot.forEach(doc => {
                const data = doc.data();
                vehicleList.push({
                    id: doc.id,
                    displayName: `${data.year} ${data.make} ${data.model} - $${parseFloat(data.price).toLocaleString('en-US')}` // Include price
                });
            });
        }
    
        function renderFilteredVehicles(filteredVehicles) {
            const dropdown = document.getElementById('vehicle-options');
            dropdown.innerHTML = ''; // Clear existing options
    
            if (filteredVehicles.length === 0) {
                const noResult = document.createElement('li');
                noResult.textContent = 'No vehicles found';
                noResult.style.color = '#999';
                dropdown.appendChild(noResult);
            } else {
                filteredVehicles.forEach(vehicle => {
                    const option = document.createElement('li');
                    option.textContent = vehicle.displayName;
                    option.dataset.value = vehicle.id;
                    dropdown.appendChild(option);
                });
            }
    
            dropdown.style.display = 'block'; // Show dropdown
        }
    
        function filterVehicles(searchTerm) {
            const filteredVehicles = vehicleList.filter(vehicle =>
                vehicle.displayName.toLowerCase().includes(searchTerm.toLowerCase())
            );
            renderFilteredVehicles(filteredVehicles);
        }
    
        function adjustDropdownWidth() {
            const inputField = document.getElementById('vehicle-search');
            const dropdown = document.getElementById('vehicle-options');
    
            // Get the computed width of the input field
            const inputWidth = inputField.offsetWidth;
            dropdown.style.width = `${inputWidth}px`;
        }
    
        document.getElementById('vehicle-search').addEventListener('focus', adjustDropdownWidth);
    
        function selectVehicle(vehicleId, displayName) {
            // Show selected vehicle
            const selectedVehicleContainer = document.getElementById('selected-vehicle');
            const selectedVehicleText = document.getElementById('selected-vehicle-text');
    
            selectedVehicleContainer.style.display = 'flex';
            selectedVehicleText.textContent = displayName;
    
            // Hide dropdown
            const dropdown = document.getElementById('vehicle-options');
            dropdown.style.display = 'none';
    
            // Save selected vehicle ID (optional: for form submission)
            const vehicleInput = document.getElementById('vehicle-selection');
            vehicleInput.value = vehicleId;
    
            // Clear the search input field
            vehicleSearchInput.value = '';
        }
    
        document.addEventListener("DOMContentLoaded", async () => {
            const vehicleSearchInput = document.getElementById('vehicle-search');
            const dropdown = document.getElementById('vehicle-options');
            const clearButton = document.getElementById('clear-selection');
    
            // Populate vehicle list
            await populateVehicleList();
    
            // Event listener for input
            vehicleSearchInput.addEventListener('input', () => {
                const searchTerm = vehicleSearchInput.value;
                if (searchTerm) {
                    filterVehicles(searchTerm);
                } else {
                    dropdown.style.display = 'none'; // Hide dropdown if input is empty
                }
            });
    
            // Event listener for dropdown option selection
            dropdown.addEventListener('click', (event) => {
                const selectedOption = event.target;
                if (selectedOption.tagName === 'LI' && selectedOption.dataset.value) {
                    selectVehicle(selectedOption.dataset.value, selectedOption.textContent);
                    vehicleSearchInput.value = ''; // Clear input field
                }
            });
    
            // Event listener to clear selection
            clearButton.addEventListener('click', () => {
                const selectedVehicleContainer = document.getElementById('selected-vehicle');
                const vehicleInput = document.getElementById('vehicle-selection');
    
                selectedVehicleContainer.style.display = 'none';
                vehicleInput.value = ''; // Clear selected vehicle
            });
        });

        // Handle form submission
    document.querySelector(".test-drive-from").addEventListener("submit", async (event) => {
        event.preventDefault(); // Prevent default form submission

        // Collect personal information
        const formData = {
            formType: "test-drive",
            firstName: document.getElementById("first-name").value,
            lastName: document.getElementById("last-name").value,
            phone: document.getElementById("phone").value,
            email: document.getElementById("email").value,
            contactMethod: document.getElementById("contact-method").value,
            selectedVehicle: document.getElementById("selected-vehicle-text").textContent || null,
            availability: [],
            timestamp: serverTimestamp(),
        };

        // Collect availability data
        const days = document.querySelectorAll(".day-toggle:checked");
        days.forEach(day => {
            const dayName = day.value;
            const selectedTimes = Array.from(
                day.closest(".day").querySelectorAll(".selected-times div")
            ).map(timeDiv => timeDiv.textContent.replace("✖", "").trim());

            formData.availability.push({ day: dayName, times: selectedTimes });
        });

        try {
            // Save data to Firestore in the 'new-forms' collection
            await addDoc(collection(db, "new-forms"), formData);

            document.querySelector(".test-drive-from").reset(); // Reset form
            document.getElementById("selected-vehicle-text").textContent = ""; // Clear selected vehicle
            alert("Form submitted successfully!");
        } catch (error) {
            console.error("Error submitting form: ", error);
            alert("Error submitting form. Please try again.");
        }
    });
    </script>
    
    <script>
document.addEventListener("DOMContentLoaded", () => {
    const availabilityContainer = document.querySelector(".availability-container");

    // Generate time options dynamically for each day
    const generateTimeOptions = (day) => {
        const times = [];
        let startHour, endHour;

        // Define working hours for each day
        switch (day) {
            case "Monday":
            case "Tuesday":
            case "Wednesday":
            case "Thursday":
                startHour = 10;
                endHour = 19; // 7 PM
                break;
            case "Friday":
            case "Saturday":
                startHour = 10;
                endHour = 18; // 6 PM
                break;
            default:
                return ""; // Invalid day
        }

        // Generate time slots
        for (let hour = startHour; hour <= endHour; hour++) {
            const formattedHour = hour % 12 === 0 ? 12 : hour % 12; // Convert to 12-hour format
            const amPm = hour < 12 ? "AM" : "PM";
            const timeString = `${formattedHour}:00 ${amPm}`;
            times.push(`<option value="${timeString}">${timeString}</option>`);
        }

        return times.join("");
    };

    // Populate time options for each day's start and end time dropdowns
    const populateTimeOptions = () => {
        document.querySelectorAll(".day").forEach(dayElement => {
            const day = dayElement.getAttribute("data-day"); // Get day name from the data attribute
            const timeOptionsHTML = generateTimeOptions(day);

            const startTimeSelect = dayElement.querySelector(".start-time");
            const endTimeSelect = dayElement.querySelector(".end-time");

            if (timeOptionsHTML) {
                startTimeSelect.innerHTML = timeOptionsHTML;
                endTimeSelect.innerHTML = timeOptionsHTML;
                startTimeSelect.disabled = false;
                endTimeSelect.disabled = false;
            } else {
                // Disable dropdowns for closed days
                startTimeSelect.innerHTML = "";
                endTimeSelect.innerHTML = "";
                startTimeSelect.disabled = true;
                endTimeSelect.disabled = true;
            }
        });
    };

    // Call populateTimeOptions after DOM is fully loaded
    populateTimeOptions();

    // Show or hide time-picker based on checkbox toggle
    availabilityContainer.addEventListener("change", (event) => {
        if (event.target.classList.contains("day-toggle")) {
            const timePicker = event.target.closest(".day").querySelector(".time-picker");
            timePicker.style.display = event.target.checked ? "block" : "none";
        }
    });

    // Add time slot functionality
    availabilityContainer.addEventListener("click", (event) => {
        if (event.target.classList.contains("add-time-slot")) {
            const timeSlot = event.target.closest(".time-slot");
            const startTime = timeSlot.querySelector(".start-time").value;
            const endTime = timeSlot.querySelector(".end-time").value;

            if (startTime && endTime) {
                const selectedTimes = timeSlot.closest(".time-picker").querySelector(".selected-times");

                // Prevent duplicates
                const newTimeRange = `${startTime} to ${endTime}`;
                const existingTimes = Array.from(selectedTimes.children).map(div => div.textContent.replace("✖", "").trim());

                if (!existingTimes.includes(newTimeRange)) {
                    const timeDiv = document.createElement("div");
                    timeDiv.textContent = newTimeRange;

                    // Add remove button
                    const removeButton = document.createElement("button");
                    removeButton.textContent = "✖";
                    removeButton.style.marginLeft = "8px";
                    removeButton.style.cursor = "pointer";
                    removeButton.addEventListener("click", () => {
                        timeDiv.remove();
                    });

                    timeDiv.appendChild(removeButton);
                    selectedTimes.appendChild(timeDiv);
                } else {
                }
            } else {
            }
        }
    });
});
            const availabilityContainer = document.querySelector(".availability-container");
    
            // Generate time options dynamically
            const generateTimeOptions = (day) => {
            const times = [];
            let startHour, endHour;

            // Define working hours for each day
            switch (day) {
                case "Monday":
                case "Tuesday":
                case "Wednesday":
                case "Thursday":
                    startHour = 10;
                    endHour = 19; // 7 PM
                    break;
                case "Friday":
                case "Saturday":
                    startHour = 10;
                    endHour = 18; // 6 PM
                    break;
                default:
                    return ""; // Invalid day
            }

            // Generate time slots
            for (let hour = startHour; hour <= endHour; hour++) {
                const formattedHour = hour % 12 === 0 ? 12 : hour % 12; // Convert to 12-hour format
                const amPm = hour < 12 ? "AM" : "PM";
                const timeString = `${formattedHour}:00 ${amPm}`;
                times.push(`<option value="${timeString}">${timeString}</option>`);
            }

            return times.join("");
        };

    
            const timeOptionsHTML = generateTimeOptions();
    
            const populateTimeOptions = () => {
        document.querySelectorAll(".day").forEach(dayElement => {
            const day = dayElement.getAttribute("data-day"); // Get day name from the data attribute
            const timeOptionsHTML = generateTimeOptions(day);

            // Populate start and end time dropdowns
            const startTimeSelect = dayElement.querySelector(".start-time");
            const endTimeSelect = dayElement.querySelector(".end-time");

            if (timeOptionsHTML) {
                startTimeSelect.innerHTML = timeOptionsHTML;
                endTimeSelect.innerHTML = timeOptionsHTML;
            } else {
                // Disable dropdowns for closed days
                startTimeSelect.disabled = true;
                endTimeSelect.disabled = true;
            }
        });
    };

    // Call populateTimeOptions after DOM is fully loaded
    document.addEventListener("DOMContentLoaded", populateTimeOptions);
    
            // Show or hide time-picker based on checkbox
            availabilityContainer.addEventListener("change", (event) => {
                if (event.target.classList.contains("day-toggle")) {
                    const timePicker = event.target.closest(".day").querySelector(".time-picker");
                    timePicker.style.display = event.target.checked ? "block" : "none";
                }
            });
    
            // Add time slot functionality
            availabilityContainer.addEventListener("click", (event) => {
                if (event.target.classList.contains("add-time-slot")) {
                    const timeSlot = event.target.closest(".time-slot");
                    const startTime = timeSlot.querySelector(".start-time").value;
                    const endTime = timeSlot.querySelector(".end-time").value;
    
                    if (startTime && endTime) {
                        const selectedTimes = timeSlot.closest(".time-picker").querySelector(".selected-times");
    
                        // Prevent duplicates by checking if the same range already exists
                        const existingTimes = Array.from(selectedTimes.children).map(div => div.textContent.trim());
                        const newTimeRange = `${startTime} to ${endTime}`;
    
                        if (!existingTimes.includes(newTimeRange)) {
                            const timeDiv = document.createElement("div");
                            timeDiv.textContent = newTimeRange;
    
                            // Add remove button
                            const removeButton = document.createElement("button");
                            removeButton.textContent = "✖"; // Use a small icon or symbol for a cleaner look
                            removeButton.style.marginLeft = "8px";
                            removeButton.style.padding = "4px 8px";
                            removeButton.style.fontSize = "12px";
                            removeButton.style.background = "var(--main-color)";
                            removeButton.style.border = "none";
                            removeButton.style.color = "white";
                            removeButton.style.borderRadius = "4px";
                            removeButton.style.cursor = "pointer";
                            removeButton.style.transition = "background-color 0.3s ease";
                            removeButton.addEventListener("click", () => {
                                timeDiv.remove();
                            });
    
                            timeDiv.appendChild(removeButton);
                            selectedTimes.appendChild(timeDiv);
                        } else {
                        }
                    } else {
                    }
                }
            });

            
    </script>

    <!-- Navbar Toggle for Mobile -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const menuIcon = document.getElementById('menu-icon');
        const navbar = document.querySelector('.navbar');

        if (menuIcon && navbar) {
            menuIcon.addEventListener('click', () => {
                navbar.classList.toggle('active');
            });
        }
    });
</script>
    

</body>

</html>